# Database

## ディレクトリ構成
```
.
├── schema
│   └── user.sql
├── script
│   └── init_database.sh
└── seed
    └── user.dump.sql
```

### schema
- CREATE TABLEなどのDDLを記述する。

### script
- databaseに関連するシェルスクリプトを記述する。
- 本スクリプトを実行し、DBの初期化、DDLの実行、テストデータの投入を行う。

### seed
- テーブルのダンプデータ等のテストデータを記述する。

## テーブル設計

### 構成
- 1テーブルの粒度は単一テーブルの更新で済む程度に小さくする。
- PK、UK、NOT NULL、CHECK制約を活用する。
- 実行計画を活用し適切にindexを貼る。

### 命名
- テーブル名は基本単数系にする。 
  - 英語は「s」を付け足さず複数形になる名詞（不可算名詞）があり、統一性を保つため単数系にする。
    - 例：「Money」
  - テーブルはデータを入れる「箱」であるため単数系でも不自然ではない。
- テーブル名、カラム名は英小文字でスネークケースを利用する。
- テーブル名、カラム名に予約語は使わない。
  - 例：「order」→「order_name」 
- テーブル名に動詞を使わない。
- idはテーブル名等をprefixとして「テーブル名_id」にする。
  - 例：「user_id」
- 関連するものは冗長でもプレフィックスを揃える。
- テーブルの種別は接尾辞(suffix)を利用する。
  - 「_ms」（マスタ）
    - 管理者のみが追加・管理するテーブル。
      - 例：国・都道府県
  - 「_log」（ログ）
  - 「_vw」（マテリアライズド・ビューテーブル）
    - 事前に計算されているテーブル。複数テーブルをバッチやトリガーにて1テーブルに集約されている場合。
- 中間テーブルの命名は「テーブル名＋テーブル名」ではなく、意味が伝える命名にする。

## 作業開始手順
- init_schema.sqlを実行
- init_migration.sqlを実行